# ------ general ------------------------------------
if-shell '[ -f /usr/bin/fish ]' 'set -g default-shell /usr/bin/fish'
if-shell '[ -f /usr/local/bin/fish ]' 'set -g default-shell /usr/local/bin/fish'
if-shell '[ -f /opt/homebrew/bin/fish ]' 'set -g default-shell /usr/local/bin/fish'

# bind-key -n F8 split-window -h
bind - splitw -v -c '#{pane_current_path}' # 垂直方向新增面板，默认进入当前目录
bind | splitw -h -c '#{pane_current_path}' # 水平方向新增面板，默认进入当前目录

bind -n S-Left previous-window
bind -n S-Right next-window

bind C-s send-prefix -2

bind c new-window -c "#{pane_current_path}"
bind u last
bind-key r source-file ~/.tmux.conf \; display-message "~/.tmux.conf reloaded"
bind s choose-tree -s -O time

unbind %
unbind '"'

set-option -ga terminal-overrides ",*256col*:Tc"
set -g default-terminal "screen-256color"

set -g base-index 1
set -g focus-events on
set -g mouse on
set -g renumber-windows on
set -sg escape-time 0
set -wg pane-base-index 1

set -wg mode-keys vi # 开启vi风格后，支持vi的C-d、C-u、hjkl等快捷键
setw -gq utf8 on

set -wg allow-rename off
set-option -g automatic-rename-format '#{b:pane_current_path}'

# ------ move around --------------------------------
bind -r h select-pane -L
bind -r l select-pane -R        # remove repeat, because of ls
bind -r j select-pane -D
bind -r k select-pane -U


bind -r C-k resize-pane -U 5
bind -r C-j resize-pane -D 5
bind -r C-h resize-pane -L 5
bind -r C-l resize-pane -R 5
bind-key -n C-t switch-client -l

# ------ status theme -------------------------------
set -g message-style "bg=#00346e, fg=#D8DEE9"       

set -g status-interval 1 # 状态栏刷新时间
set -g status-style "bg=#2E3440, fg=#ECEFF4"         
set -g status-left-length 400
set -g status-left "#[bg=#2E3440, fg=#EBCB8B]#S"             
# set -g status-right-length 400G
# set -g status-right "#{sysstat_cpu} | #{sysstat_mem} | #{sysstat_swap} | #{sysstat_loadavg} | #[fg=cyan]#(echo $USER)#[default]@#H"
# set -g status-right "#{net_speed} | #{sysstat_cpu} | #{sysstat_mem}"
# set -g @sysstat_mem_view_tmpl '#{mem.used}/#{mem.total}'
set -g status-right "#(echo $USER)#[default]@#H"

set -g set-clipboard on
set -g history-limit 9999

set -wg window-status-format " #I.#W "
set -wg window-status-current-format " #I.#W "

set -wg window-status-separator ""

set -wg window-status-current-style "bg=#E5E9F0, fg=#2E3440"
set -wg window-status-last-style "fg=#E5E9f0"
set -wg window-status-style "fg=#E5E9f0"

set -wg pane-active-border-style "fg=#E5E9F0"
set -wg pane-border-style "fg=#E5E9F0"       

############# 'tmux-plugins/tmux-resurrect' {
# for vim
# set -g @resurrect-strategy-vim 'session'
# for neovim
set -g @resurrect-strategy-nvim 'session'
# set -g @resurrect-processes '~Vim -> vim'
############# 'tmux-plugins/tmux-resurrect' }

############# 'tmux-plugins/tmux-continuum' }
set -g @continuum-save-interval '3'
set -g @continuum-restore 'on'
############# 'tmux-plugins/tmux-continuum' }

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-continuum'

#set -g @plugin 'tmux-plugins/tmux-net-speed'
#set -g @plugin 'samoshkin/tmux-plugin-sysstat'
# set -g @plugin "arcticicestudio/nord-tmux"

#set -g @net_speed_interfaces "wlp4s0"
# set -g @download_speed_format "%10s"
# set -g @upload_speed_format "%10s"
#set -g @net_speed_format "D:%1s U:%1s"

# Other examples:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'git@github.com:user/plugin'
# set -g @plugin 'git@bitbucket.com:user/plugin'
run '~/.tmux/plugins/tpm/tpm'

set-option -gw xterm-keys on

# bind-key -n Tab  next-window
# bind-key -n BTab previous-window

bind -n C-M-t new-window
bind-key -n C-M-r source-file ~/.tmux.conf \; display-message "~/.tmux.conf reloaded"
